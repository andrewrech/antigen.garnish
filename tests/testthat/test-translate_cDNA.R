library(testthat)
library(antigen.garnish)
library(data.table)
library(magrittr)
library(dt.inflix)

testthat::test_that("translate_cDNA", {

  # load test data
  v <- "ATGTCTTCTTTTGCTTGCTGGAGCCTGTCTCTTCTTATCCTGTTCTACAGCCCAGGGTCTGGTGAGAAGGCCTTTGAGGTCTACATATGGTCCGAGAAGCAGATAGTAGAAGCCACAGAGTCTTGGAAAATCAACTGCAGCACCAACTGCGCAGCCCCAGACATGGGCGGCCTGGAGACGCCCACGAATAAAATAATGTTGGAAGAGCATCCTCAAGGGAAGTGGAAACAGTTCTTAGTCTCAAACGTCTCCAAAGACACGGTCTTCTTTTGCCATTTCACGTGTTCGGGAAAGCAGCACTCGGAGAGTCTCAACATCAGGGTGTACCAGCCTCCAGCTCAAGTCACACTGAAGCTGCAGCCGCCTCGGGTGTTTGTGGGTGAAGACTTCACCATTGAGTGCACGGTGTCCCCTGTGCAGCCCCTTGAGAGGCTCACCCTCTCTCTGCTCCGTGGCAGAGAGACCCTGAAGAATCAGACCTTTGGGGGAGCAGAAACTGTCCCCCAAGAGGCCACAGCCACGTTCAACAGCACAGCTCTGAAAAAGGACGGTCTCAACTTTTCCTGCCAGGCTGAGCTGGATCTACGGCCCCATGGTGGGTATATCATCCGCAGCATCTCGGAGTACCAGATCCTTGAAGTCTATGAGCCGATGCAGGACAACCAAATGGTCATCATCATCGTGGTGGTGTCAATACTGCTGTTCTTATTTGTGACATCTGTCCTGCTATGCTTTATCTTTGGCCAGCACTGGCACAGAAGACGGACAGGCACCTACGGGGTGCTAGCTGCCTGGAGGAGGCTGCCCCGAGCCTTTCGGGCACGTCCCGTGTGA"

  # run test
   translate_cDNA(v) %>%
   testthat::expect_equal(., "MSSFACWSLSLLILFYSPGSGEKAFEVYIWSEKQIVEATESWKINCSTNCAAPDMGGLETPTNKIMLEEHPQGKWKQFLVSNVSKDTVFFCHFTCSGKQHSESLNIRVYQPPAQVTLKLQPPRVFVGEDFTIECTVSPVQPLERLTLSLLRGRETLKNQTFGGAETVPQEATATFNSTALKKDGLNFSCQAELDLRPHGGYIIRSISEYQILEVYEPMQDNQMVIIIVVVSILLFLFVTSVLLCFIFGQHWHRRRTGTYGVLAAWRRLPRAFRARPV*")
    })
