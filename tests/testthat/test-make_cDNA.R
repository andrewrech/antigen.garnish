library(testthat)
library(antigen.garnish)
library(data.table)
library(magrittr)
library(dt.inflix)

testthat::test_that("make_cDNA", {

  # load test data
    dt <- data.table::data.table(cDNA_type = c(">", ">"),
      coding = c("ATGGCAGAGTTCTCCCAGAAGCAGAGGAAACAGAGCGGCAGCGAGGGCCTGGGCAGTGTGGTGGACTTCCTCTTGGCTAATGCTCGATTGGTGCTAGGTGTGGGCGGGGCTGCAGTGCTGGGCATTGCTACCCTGGCTGTAAAGCGGCTCATCGACAGGGCCACCAGCCCTCCAGATGAGGATGACACCAAGGGGGACAGCTGGAAGGAACTGAGCCTGCTGAGAGCCACATCGCCCCAAAAGCCCCAACCCCCTCCTGCTGCCTTCAGCCAGCCCCTAGCTACTGGGTCCCCCTCCCCCTCTGTGCCAGTGGAGCCCACGCCCATTCATTCTCCCACGACACCTAAGTTCAGCACTATAGCACCCCTGTGCCTGACGTTCCAGGAGAGGCTGCTGGCCTTCGAGCGCAAGCATGTGATTACCCCAGAAGCCCACGTGACGTTGGCGAAACAGCTGGCTGGAGACATTGCCTTGGAGCTGCAGGCCTACTTGAGGAGCAAGTTCCCAGAACTGCCCTTTGGTGCACTCGTGCCGGGTGGGCCTCTCTACGACGGGCTCCAGGCAGGGACTGCTGAGCACGTGCGCCTGCTGGCGCCTCTGGAGTTGGAGCCGGGGCTATGGAGCCTGGTACCTGGCGTGGACACTGTGGCCAGGGAGCCTCGATGCTGGGCTGTACGCAGGACTCAGCTTGAGTTTCATCCCCGTGGGTGCAGCCCATGGGACCGCTTCCTGGTGGGGGGCTACCTCTCCTCCCGAGTCTTGCTGGAGCTGCTACGGAAGGCCCTGTCAGCCTCTGTCAACTGGCCAGCCATTGGCAGCCTGCTCGGGTGTCTGATCTGGCCCGATGTGGCTTCGGAGGAGCTGCTGCTCAAAGTGCAACACGAGTGCCTGGAGTTCACTTTAGCTGTGCTCATGGTAGTCCCTGGGGCCAGCACTGATGACCGCCTGCTGCTGGCTTGGCCCCTAGAGGGGCTGGCCAGCAATCTCTGGCTGCAGGATCTATATCCAGTAGAGACCGCCCGTTTGCGGGCCCTGGATGACCAGGATGCTGGTACTCGGCGGAGGTTGTTGCTGCTGCTGTGTGGTATCTGTCGTGGCCATCCGGCTCTAGTGCGGCTGGGCTGGAGCCACCTGACTCAGGTGGTTCTGCATCTGGGTGAAGAGGAAGTGGCCTGGACTGAGGAGGCCTTGGGGGAACGGTTTCTGCAAGCCCTGGAGTTTCTGGTGGGCAGCTTGGAGCAGGCTAGCCTGCCCTGTCACTTCAACCCCAGTGTGAACCTCTTGGGTAACTTCCGGGAAGAGGAGATTGATGACATTGGCTACGTGCTGTACAGCGGCCTCCAGGTTCCTGAAAGCCTATTCTAG",
      "ATGGCGGCCGCCAGCGGCTACACCGACCTGCGGGAGAAGCTCAAGTCCATGACGTCCCGGGACAACTACAAGGCGGGCAGTCGGGAGGCCGCCGCCGCTGCGGCCGCCGCCGTGGCTGCCGCTGCCGCTGCCGCGGCCGCCGCTGAGCCTTACCCGGCGTCCGGGACCACCAAGCGGAAATACCAGGAGGACTCGGACCCCGAGCGCAGCGACTACGAGGAGCATCAGTTGCAGAAGGAGGAAGAGGCGCGCAAGGTGAAGAGCGGCATCCGGCAGATCCGGCTCTTCAGTCAGGATGAGTGCTCCAAGATCGAGGCCCGCATCGATGAGGTGGTGTCCCGCGCCGAGAAGGGCCTGTACAACGAGCACACGGTGGACCGGGCCCCCCTGCGCAACAAGTACTTCTTCGGCGAGGGCTACACGTACGGGGCCCAGCTGCAGAAGCGCGGGCCGGGCCAGGAGCGCCTCTACCCGCCGGGCGACGTCGACGAGATCCCGGACTGGGTGCATCAGCTGGTGATCCAGAAGCTGGTGGAGCACCGCGTCATCCCCGAGGGCTTCGTCAACAGCGCGGTCATCAACGACTACCAGCCCGGCGGCTGCATCGTGTCCCACGTTGACCCCATCCACATCTTCGAGCGCCCCATCGTGTCCGTGTCTTTCTTCAGCGACTCGGCACTTTGCTTCGGCTGCAAGTTCCAGTTCAAGCCCATCCGGGTGTCGGAACCTGTGCTTTCTCTGCCGGTGCGCAGGGGGAGCGTGACTGTGCTCAGTGGGTATGCTGCTGATGAAATCACTCACTGCATACGGCCTCAGGACATTAAGGAACGCCGGGCGGTCATCATTCTCAGGAAGACAAGATTAGATGCACCGCGATTGGAAACAAAATCCCTGAGCAGCTCCACATTGCCACCCAGCTATGCTTCAGATCGCCTGTCAGGAAACACCAGAGACCCTGCGCTGAAACCCAAAAGGTCCCACCGCAAGGCAGACCCTGATGCTGCCCACAGGCCCCGGATCCTGGAAATGGACAAAGAAGAAAACCGGCGGTCTGTGCTCCTGCCCACACACCGGCGGAGGGGGAGTTTTAGCTCTGAGAACTATTGGCGCAAATCCTATGAGTCCTCGGAAGATTGCCCAGAGGCAGCCAGCAGCCCCACCCGCAAGGTGAAGATGAGGAGACACTGA"),
      cDNA_locs = c(718L, 1114L),
      cDNA_locl = c(718L, 1114L),
      cDNA_seq = c("A", "G"))

  # run test
    dto <- make_cDNA(dt)

    testthat::expect_equal(dto$coding_mut,
    c("ATGGCAGAGTTCTCCCAGAAGCAGAGGAAACAGAGCGGCAGCGAGGGCCTGGGCAGTGTGGTGGACTTCCTCTTGGCTAATGCTCGATTGGTGCTAGGTGTGGGCGGGGCTGCAGTGCTGGGCATTGCTACCCTGGCTGTAAAGCGGCTCATCGACAGGGCCACCAGCCCTCCAGATGAGGATGACACCAAGGGGGACAGCTGGAAGGAACTGAGCCTGCTGAGAGCCACATCGCCCCAAAAGCCCCAACCCCCTCCTGCTGCCTTCAGCCAGCCCCTAGCTACTGGGTCCCCCTCCCCCTCTGTGCCAGTGGAGCCCACGCCCATTCATTCTCCCACGACACCTAAGTTCAGCACTATAGCACCCCTGTGCCTGACGTTCCAGGAGAGGCTGCTGGCCTTCGAGCGCAAGCATGTGATTACCCCAGAAGCCCACGTGACGTTGGCGAAACAGCTGGCTGGAGACATTGCCTTGGAGCTGCAGGCCTACTTGAGGAGCAAGTTCCCAGAACTGCCCTTTGGTGCACTCGTGCCGGGTGGGCCTCTCTACGACGGGCTCCAGGCAGGGACTGCTGAGCACGTGCGCCTGCTGGCGCCTCTGGAGTTGGAGCCGGGGCTATGGAGCCTGGTACCTGGCGTGGACACTGTGGCCAGGGAGCCTCGATGCTGGGCTGTACGCAGGACTCAGCTTGAGTTTCATCCCCGTGGGTGCAGCCCAAGGGACCGCTTCCTGGTGGGGGGCTACCTCTCCTCCCGAGTCTTGCTGGAGCTGCTACGGAAGGCCCTGTCAGCCTCTGTCAACTGGCCAGCCATTGGCAGCCTGCTCGGGTGTCTGATCTGGCCCGATGTGGCTTCGGAGGAGCTGCTGCTCAAAGTGCAACACGAGTGCCTGGAGTTCACTTTAGCTGTGCTCATGGTAGTCCCTGGGGCCAGCACTGATGACCGCCTGCTGCTGGCTTGGCCCCTAGAGGGGCTGGCCAGCAATCTCTGGCTGCAGGATCTATATCCAGTAGAGACCGCCCGTTTGCGGGCCCTGGATGACCAGGATGCTGGTACTCGGCGGAGGTTGTTGCTGCTGCTGTGTGGTATCTGTCGTGGCCATCCGGCTCTAGTGCGGCTGGGCTGGAGCCACCTGACTCAGGTGGTTCTGCATCTGGGTGAAGAGGAAGTGGCCTGGACTGAGGAGGCCTTGGGGGAACGGTTTCTGCAAGCCCTGGAGTTTCTGGTGGGCAGCTTGGAGCAGGCTAGCCTGCCCTGTCACTTCAACCCCAGTGTGAACCTCTTGGGTAACTTCCGGGAAGAGGAGATTGATGACATTGGCTACGTGCTGTACAGCGGCCTCCAGGTTCCTGAAAGCCTATTCTAG",
    "ATGGCGGCCGCCAGCGGCTACACCGACCTGCGGGAGAAGCTCAAGTCCATGACGTCCCGGGACAACTACAAGGCGGGCAGTCGGGAGGCCGCCGCCGCTGCGGCCGCCGCCGTGGCTGCCGCTGCCGCTGCCGCGGCCGCCGCTGAGCCTTACCCGGCGTCCGGGACCACCAAGCGGAAATACCAGGAGGACTCGGACCCCGAGCGCAGCGACTACGAGGAGCATCAGTTGCAGAAGGAGGAAGAGGCGCGCAAGGTGAAGAGCGGCATCCGGCAGATCCGGCTCTTCAGTCAGGATGAGTGCTCCAAGATCGAGGCCCGCATCGATGAGGTGGTGTCCCGCGCCGAGAAGGGCCTGTACAACGAGCACACGGTGGACCGGGCCCCCCTGCGCAACAAGTACTTCTTCGGCGAGGGCTACACGTACGGGGCCCAGCTGCAGAAGCGCGGGCCGGGCCAGGAGCGCCTCTACCCGCCGGGCGACGTCGACGAGATCCCGGACTGGGTGCATCAGCTGGTGATCCAGAAGCTGGTGGAGCACCGCGTCATCCCCGAGGGCTTCGTCAACAGCGCGGTCATCAACGACTACCAGCCCGGCGGCTGCATCGTGTCCCACGTTGACCCCATCCACATCTTCGAGCGCCCCATCGTGTCCGTGTCTTTCTTCAGCGACTCGGCACTTTGCTTCGGCTGCAAGTTCCAGTTCAAGCCCATCCGGGTGTCGGAACCTGTGCTTTCTCTGCCGGTGCGCAGGGGGAGCGTGACTGTGCTCAGTGGGTATGCTGCTGATGAAATCACTCACTGCATACGGCCTCAGGACATTAAGGAACGCCGGGCGGTCATCATTCTCAGGAAGACAAGATTAGATGCACCGCGATTGGAAACAAAATCCCTGAGCAGCTCCACATTGCCACCCAGCTATGCTTCAGATCGCCTGTCAGGAAACACCAGAGACCCTGCGCTGAAACCCAAAAGGTCCCACCGCAAGGCAGACCCTGATGCTGCCCACAGGCCCCGGATCCTGGAAATGGACAAAGAAGAAAACCGGCGGTCTGTGCTCCTGCCCACACACCGGCGGAGGGGGAGTTTTAGCTCTGAGAACTATTGGCGCAAAGCCTATGAGTCCTCGGAAGATTGCCCAGAGGCAGCCAGCAGCCCCACCCGCAAGGTGAAGATGAGGAGACACTGA"
    ))
    })