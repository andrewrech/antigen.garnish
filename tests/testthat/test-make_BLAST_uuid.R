library(testthat)
library(antigen.garnish)
library(data.table)
library(magrittr)
library(dt.inflix)

testthat::test_that("make_BLAST_uuid", {

  if (length(system("which blastp", intern = TRUE)) != 1){
   testthat::skip("Skipping make_BLAST_uuid because ncbiblast+ is not in PATH")
   }

  # load test data
    dt <- structure(list(pep_mut = c("MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKAYESSEDCPEAASSPTRKVKMRRH"
    ),
    pep_wt = c("MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH",
    "MAAASGYTDLREKLKSMTSRDNYKAGSREAAAAAAAAVAAAAAAAAAAEPYPASGTTKRKYQEDSDPERSDYEEHQLQKEEEARKVKSGIRQIRLFSQDECSKIEARIDEVVSRAEKGLYNEHTVDRAPLRNKYFFGEGYTYGAQLQKRGPGQERLYPPGDVDEIPDWVHQLVIQKLVEHRVIPEGFVNSAVINDYQPGGCIVSHVDPIHIFERPIVSVSFFSDSALCFGCKFQFKPIRVSEPVLSLPVRRGSVTVLSGYAADEITHCIRPQDIKERRAVIILRKTRLDAPRLETKSLSSSTLPPSYASDRLSGNTRDPALKPKRSHRKADPDAAHRPRILEMDKEENRRSVLLPTHRRRGSFSSENYWRKSYESSEDCPEAASSPTRKVKMRRH"
    ), pep_type = c("wt", "wt", "wt", "wt", "wt", "wt", "wt", "wt",
    "mutnfs", "mutnfs", "mutnfs", "mutnfs", "mutnfs", "mutnfs", "mutnfs",
    "mutnfs"), nmer = c("SENYWRKS", "ENYWRKSY", "NYWRKSYE", "YWRKSYES",
    "WRKSYESS", "RKSYESSE", "KSYESSED", "SYESSEDC", "SENYWRKA", "ENYWRKAY",
    "NYWRKAYE", "YWRKAYES", "WRKAYESS", "RKAYESSE", "KAYESSED", "AYESSEDC"
    ), nmer_i = c(1L, 2L, 3L, 4L, 5L, 6L, 7L, 8L, 1L, 2L, 3L,
    4L, 5L, 6L, 7L, 8L), nmer_l = c(8L, 8L, 8L, 8L, 8L, 8L,
    8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L, 8L), var_uuid = c("03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e", "03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e", "03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e", "03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e", "03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e", "03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e", "03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e", "03be9361-14a0-4087-bddb-fc02c14f359e",
    "03be9361-14a0-4087-bddb-fc02c14f359e"), frameshift = c(FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE,
    FALSE, FALSE, FALSE, FALSE, FALSE, FALSE)), .Names = c("pep_mut",
    "pep_wt", "pep_type", "nmer", "nmer_i", "nmer_l", "var_uuid",
    "frameshift"), sorted = "var_uuid", class = c("data.table",
    "data.frame"), row.names = c(NA, -16L))

    dti <- dt %>% data.table::copy %>%
      .[, MHC := "H-2-Kb"] %>%
        .[, nmer_uuid := uuid::UUIDgenerate(), by = "nmer"] %>%
          .[, sample_id := "my_sample"] %>%
            .[, effect_type := "missense_variant"]

  # run test
    dto <- make_BLAST_uuid(dti) %>% .[order(nmer)]

   testthat::expect_equal(dto[!is.na(blast_uuid), nmer],
                        c("ENYWRKAY",
                          "ENYWRKSY",
                          "NYWRKAYE",
                          "NYWRKSYE"))

   testthat::expect_equal(dto[, pep_type %>% table],
     structure(c(8L, 10L), .Dim = 2L, .Dimnames = structure(list(. = c("mutnfs",
     "wt")), .Names = "."), class = "table"))

     if (file.exists("Multi_hits.csv")) file.remove("Multi_hits.csv")

    })
